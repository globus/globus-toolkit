#!/usr/bin/make -f
# -*- makefile -*-

# see EXAMPLES in dpkg-buildflags(1) and read /usr/share/dpkg/*
DPKG_EXPORT_BUILDFLAGS = 1
include /usr/share/dpkg/default.mk

# see FEATURE AREAS in dpkg-buildflags(1)
#export DEB_BUILD_MAINT_OPTIONS = hardening=+all

name = globus-connect-gridftp-server
libname = globus-gridftp-server
version = 12.19
soname = 6
_prefix = /usr
_includedir = $(_prefix)/include
_libdir = $(_prefix)/lib/$(DEB_HOST_MULTIARCH)
_sysconfdir = /etc
_datadir = $(_prefix)/share
_mandir = $(_datadir)/man
_docdir = $(_datadir)/doc

export GRIDMAP=/etc/grid-security/grid-mapfile

override_dh_auto_install:
	dh_auto_install
	rm debian/tmp/etc/init.d/globus-gridftp-server
	mkdir -p debian/tmp/lib/systemd/system
	cp globus-gridftp-server.service debian/tmp/lib/systemd/system

override_dh_auto_configure:
	dh_auto_configure -- \
	   --docdir='$(_docdir)/lib$(libname)-dev' \
	   --includedir='$(_includedir)/globus' \
	   --datadir='$(_datadir)/globus' \
	   --libdir='$(_libdir)' \
	   --sysconfdir='$(_sysconfdir)' \
	   --libexecdir='$(_datadir)/globus' \
	   --localstatedir=/var \
	   --with-default-runlevels=2345 \
	   --disable-static

%:
	dh $@ --with autotools-dev --with systemd

.PHONY: override_dh_auto_configure override_dh_auto_install
